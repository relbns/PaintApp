(function(e){function a(a){for(var o,n,i=a[0],c=a[1],l=a[2],g=0,d=[];g<i.length;g++)n=i[g],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&d.push(s[n][0]),s[n]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);h&&h(a);while(d.length)d.shift()();return r.push.apply(r,l||[]),t()}function t(){for(var e,a=0;a<r.length;a++){for(var t=r[a],o=!0,i=1;i<t.length;i++){var c=t[i];0!==s[c]&&(o=!1)}o&&(r.splice(a--,1),e=n(n.s=t[0]))}return e}var o={},s={app:0},r=[];function n(a){if(o[a])return o[a].exports;var t=o[a]={i:a,l:!1,exports:{}};return e[a].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=o,n.d=function(e,a,t){n.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,a){if(1&a&&(e=n(e)),8&a)return e;if(4&a&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var o in e)n.d(t,o,function(a){return e[a]}.bind(null,o));return t},n.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(a,"a",a),a},n.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},n.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=a,i=i.slice();for(var l=0;l<i.length;l++)a(i[l]);var h=c;r.push([0,"chunk-vendors"]),t()})({0:function(e,a,t){e.exports=t("56d7")},"0284":function(e,a,t){},"4b71":function(e,a,t){"use strict";t("e478")},"552a":function(e,a,t){},"56d7":function(e,a,t){"use strict";t.r(a);var o=t("7a23");const s={id:"wrapper"};function r(e,a,t,r,n,i){const c=Object(o["i"])("Toolbar"),l=Object(o["i"])("PaintCanvas"),h=Object(o["i"])("Statistics"),g=Object(o["i"])("LeftImages");return Object(o["g"])(),Object(o["c"])("div",s,[Object(o["d"])("main",null,[a[0]||(a[0]=Object(o["d"])("h1",null,"Paint 2.0",-1)),Object(o["e"])(c,{onChangeBrushColor:i.updateBrushColor,onChangeBrushSize:i.updateBrushSize,onChangeBackgroundColor:i.updateBgColor,onChangeBackgroundImage:i.updateBgImage,onClearCanvas:i.clearCanvas,onDownloadImage:i.downloadImageTask,bgImageNameWatcher:n.bgFileName},null,8,["onChangeBrushColor","onChangeBrushSize","onChangeBackgroundColor","onChangeBackgroundImage","onClearCanvas","onDownloadImage","bgImageNameWatcher"]),Object(o["e"])(l,{onMousePos:i.updateMousePos,onClearBgFilename:i.clearBGfileName,onUpdateImageList:i.updateImageList,clearCanvasWatcher:n.isCanvasClear,imageBgWatcher:n.bgImage,colorBgWatcher:n.bgColor,brushSize:n.brushSize,brushColor:n.brushColor,saveImageWatcher:n.saveImage,downloadImageWatcher:n.downloadImage,showImageOnCanvasWatcher:n.showImage},null,8,["onMousePos","onClearBgFilename","onUpdateImageList","clearCanvasWatcher","imageBgWatcher","colorBgWatcher","brushSize","brushColor","saveImageWatcher","downloadImageWatcher","showImageOnCanvasWatcher"]),Object(o["e"])(h,{pos:n.pos,brushSize:n.brushSize,brushColor:n.brushColor},null,8,["pos","brushSize","brushColor"])]),Object(o["d"])("aside",null,[Object(o["e"])(g,{onSaveImage:i.saveImageTask,onShowOnCanvas:i.showImageTask,savedImageWatcher:n.savedImage},null,8,["onSaveImage","onShowOnCanvas","savedImageWatcher"])])])}const n={id:"toolbar"};function i(e,a,t,s,r,i){return Object(o["g"])(),Object(o["c"])("div",n,[Object(o["d"])("div",null,[a[9]||(a[9]=Object(o["d"])("label",{for:"brush-size"},"Size ",-1)),Object(o["l"])(Object(o["d"])("input",{id:"brush-size",type:"range",min:"1",max:"20","onUpdate:modelValue":a[0]||(a[0]=e=>r.brushSize=e),onChange:a[1]||(a[1]=a=>e.$emit("change-brush-size",r.brushSize))},null,544),[[o["k"],r.brushSize]]),a[10]||(a[10]=Object(o["d"])("label",{for:"brush-color"},"Color ",-1)),Object(o["l"])(Object(o["d"])("input",{id:"brush-color",type:"color","onUpdate:modelValue":a[2]||(a[2]=e=>r.brushColor=e),onChange:a[3]||(a[3]=a=>e.$emit("change-brush-color",r.brushColor))},null,544),[[o["k"],r.brushColor]]),a[11]||(a[11]=Object(o["d"])("label",{for:"background-color"},"Background ",-1)),Object(o["l"])(Object(o["d"])("input",{id:"background-color",type:"color","onUpdate:modelValue":a[4]||(a[4]=e=>r.backgroundColor=e),onChange:a[5]||(a[5]=a=>e.$emit("change-background-color",r.backgroundColor))},null,544),[[o["k"],r.backgroundColor]])]),Object(o["d"])("div",null,[a[12]||(a[12]=Object(o["d"])("label",{for:"fileLoadBtn"},"Load image ",-1)),Object(o["d"])("input",{id:"fileLoadBtn",type:"file",onChange:a[6]||(a[6]=(...e)=>i.getBackgroundImage&&i.getBackgroundImage(...e))},null,32),Object(o["d"])("button",{id:"downloadBtn",onClick:a[7]||(a[7]=a=>e.$emit("download-image"))}," Download "),Object(o["d"])("button",{id:"clearBtn",onClick:a[8]||(a[8]=a=>e.$emit("clear-canvas"))},"Clear")])])}t("88a7"),t("271a"),t("5494");var c={name:"Toolbar",data(){return{brushSize:1,brushColor:"#000000",backgroundColor:"#FFFFFF",backgroundImage:null}},props:{bgImageNameWatcher:Boolean},methods:{getBackgroundImage(e){const a=e.target.files[0];this.backgroundImage=URL.createObjectURL(a),this.$emit("change-background-image",this.backgroundImage)}},watch:{bgImageNameWatcher:function(){document.getElementById("fileLoadBtn").value=""}}},l=(t("fd10"),t("6b0d")),h=t.n(l);const g=h()(c,[["render",i],["__scopeId","data-v-72846347"]]);var d=g;const u=["width","height"];function m(e,a,t,s,r,n){return Object(o["g"])(),Object(o["c"])("canvas",{id:"paintCanvas",width:r.canvasWidth,height:r.canvasHeight,onChangeBrushColor:a[0]||(a[0]=(...a)=>e.updateBrushColor&&e.updateBrushColor(...a)),onChangeBrushSize:a[1]||(a[1]=(...a)=>e.updateBrushSize&&e.updateBrushSize(...a))}," Your browser does not support HTML5 ",40,u)}t("d9e2"),t("14d9");class b{constructor(){this.useServer=!1,this.forceLocalStorage=!0,this.serverUrl=Object({VUE_APP_USE_SERVER:"false",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_SERVER_URL||"http://localhost:3000",this.currentMode="localStorage",this.serverAvailable=!1,(this.useServer||!this.useServer&&!this.forceLocalStorage)&&this.checkServerAvailability()}async checkServerAvailability(){if(this.forceLocalStorage)this.fallbackToLocalStorage();else try{const e=new AbortController,a=setTimeout(()=>e.abort(),2e3),t=await fetch(this.serverUrl+"/health",{method:"GET",signal:e.signal});clearTimeout(a),t.ok?(this.serverAvailable=!0,this.currentMode="server",console.log("Server mode active")):this.fallbackToLocalStorage()}catch(e){try{const e=new AbortController,a=setTimeout(()=>e.abort(),2e3),t=await fetch(this.serverUrl+"/images",{method:"GET",signal:e.signal});clearTimeout(a),t.ok?(this.serverAvailable=!0,this.currentMode="server",console.log("Server mode active (via fallback check)")):this.fallbackToLocalStorage()}catch(a){this.fallbackToLocalStorage()}}}fallbackToLocalStorage(){this.serverAvailable=!1,this.currentMode="localStorage",console.log("Server unavailable, falling back to localStorage mode")}getCurrentMode(){return this.currentMode}async getAllImages(){if("server"!==this.currentMode||!this.serverAvailable)return this.getImagesFromLocalStorage();try{const e=await fetch(this.serverUrl+"/images");if(e.ok)return await e.json();throw new Error("Server request failed")}catch(e){return console.warn("Server request failed, falling back to localStorage:",e),this.fallbackToLocalStorage(),this.getImagesFromLocalStorage()}}async saveImage(e){const a={image:{src:e}};if("server"!==this.currentMode||!this.serverAvailable)return this.saveImageToLocalStorage(a);try{const e=await fetch(this.serverUrl+"/images",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});if(e.ok)return await e.json();throw new Error("Server request failed")}catch(t){return console.warn("Server save failed, falling back to localStorage:",t),this.fallbackToLocalStorage(),this.saveImageToLocalStorage(a)}}async deleteAllImages(){if("server"!==this.currentMode||!this.serverAvailable)return this.deleteAllImagesFromLocalStorage();try{const e=await fetch(this.serverUrl+"/images",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}});if(e.ok)return await e.json();throw new Error("Server request failed")}catch(e){return console.warn("Server delete failed, falling back to localStorage:",e),this.fallbackToLocalStorage(),this.deleteAllImagesFromLocalStorage()}}deleteImage(e){const a=this.getImagesFromLocalStorage();return a.splice(e,1),localStorage.setItem("images",JSON.stringify(a)),a}getImagesFromLocalStorage(){return JSON.parse(localStorage.getItem("images"))||[]}saveImageToLocalStorage(e){const a=this.getImagesFromLocalStorage();return a.push(e.image),localStorage.setItem("images",JSON.stringify(a)),e}deleteAllImagesFromLocalStorage(){return localStorage.removeItem("images"),{success:!0}}}var v=new b,p={name:"PaintCanvas",data(){return{xPos:0,yPos:0,canvasWidth:600,canvasHeight:400,canvas:null,context:null,isDrawing:!1,insideCanvas:!1}},props:{clearCanvasWatcher:Boolean,imageBgWatcher:String,colorBgWatcher:String,brushColor:String,brushSize:Number,showImageOnCanvasWatcher:String,saveImageWatcher:Boolean,downloadImageWatcher:Boolean},methods:{updateMousePosition(e){const a=this.canvas.getBoundingClientRect();this.xPos=e.clientX-Math.floor(a.left),this.yPos=e.clientY-Math.floor(a.top);const t={xPos:this.xPos,yPos:this.yPos};this.$emit("mouse-pos",t)},penDown(){this.isDrawing=!0,this.context.beginPath(),this.context.moveTo(this.xPos,this.yPos)},draw(){this.context.lineTo(this.xPos,this.yPos),this.context.strokeStyle=this.brushColor,this.context.lineWidth=this.brushSize,this.context.stroke()},penUp(){this.isDrawing=!1},clearCanvas(){this.backgroundColor="#FFFFFF",this.backgroundImage=null,this.canvas.style.backgroundColor=this.backgroundColor,this.canvas.style.backgroundImage="",this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.$emit("clear-bg-filename")},setBackgroundColor(){this.backgroundImage=null,this.$emit("clear-bg-filename"),this.canvas.style.backgroundImage="",this.canvas.style.backgroundColor=this.backgroundColor},setBackgroundImage(e){this.backgroundColor="#FFFFFF",this.canvas.style.backgroundColor=this.backgroundColor,this.backgroundImage=e,this.canvas.style.backgroundImage=`url('${this.backgroundImage}')`},prepareForSave(){if(this.backgroundImage){const e=new Image;e.src=this.backgroundImage,e.onload=()=>{const a=e.width/e.height;let t=this.canvas.width,o=t/a;o>this.canvas.height&&(o=this.canvas.height,t=o*a),this.context.globalCompositeOperation="destination-over",this.context.drawImage(e,0,0,t,o),this.context.globalCompositeOperation="source-over",this.saveImage()}}else this.context.fillStyle=this.backgroundColor,this.context.globalCompositeOperation="destination-over",this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.context.globalCompositeOperation="source-over",this.saveImage()},async saveImage(){const e=this.canvas.toDataURL();await v.saveImage(e);const a=JSON.stringify({image:{src:e}});this.$emit("update-image-list",a),this.clearCanvas()},downloadCanvasAsImage(){const e=document.createElement("canvas"),a=e.getContext("2d");e.width=this.canvasWidth,e.height=this.canvasHeight;const t=e=>{const a=e.toDataURL("image/png"),t=document.createElement("a");t.href=a,t.download="myDrawing.png",t.click()};if(this.backgroundImage){const o=new Image;o.crossOrigin="anonymous",o.src=this.backgroundImage,o.onload=()=>{const s=o.width/o.height;let r=e.width,n=r/s;n>e.height&&(n=e.height,r=n*s),a.drawImage(o,0,0,r,n),a.drawImage(this.canvas,0,0),t(e)},o.onerror=()=>{t(this.canvas)}}else a.fillStyle=this.backgroundColor||"#ffffff",a.fillRect(0,0,e.width,e.height),a.drawImage(this.canvas,0,0),t(e)},showSelectedOnCanvas(e){this.clearCanvas(),this.backgroundImage=e,this.canvas.style.backgroundImage=`url('${this.backgroundImage}')`}},watch:{clearCanvasWatcher:function(){this.clearCanvas()},imageBgWatcher:function(e){this.setBackgroundImage(e)},colorBgWatcher:function(e){this.backgroundColor=e,this.setBackgroundColor()},showImageOnCanvasWatcher:function(e){this.showSelectedOnCanvas(e)},saveImageWatcher:function(){this.prepareForSave()},downloadImageWatcher:function(e){e&&this.downloadCanvasAsImage()}},mounted(){this.canvas=document.getElementById("paintCanvas"),this.context=this.canvas.getContext("2d"),this.clearCanvas(),this.canvas.addEventListener("mousedown",()=>{this.penDown()}),this.canvas.addEventListener("mousemove",e=>{this.updateMousePosition(e),this.isDrawing&&this.insideCanvas&&this.draw()}),this.canvas.addEventListener("mouseup",()=>{this.penUp()}),this.canvas.addEventListener("mouseenter",()=>{this.insideCanvas=!0}),this.canvas.addEventListener("mouseout",()=>{this.insideCanvas=!1})}};t("d0c8");const f=h()(p,[["render",m],["__scopeId","data-v-1556aa11"]]);var I=f;const C={id:"statistics"},S={id:"mouse-pos"},w={id:"brush-size"},O={id:"brush-color"};function k(e,a,t,s,r,n){return Object(o["g"])(),Object(o["c"])("div",C,[Object(o["d"])("span",S,"Pos: "+Object(o["j"])(t.pos.xPos)+","+Object(o["j"])(t.pos.yPos),1),Object(o["d"])("span",w,"Brush Size: "+Object(o["j"])(t.brushSize),1),Object(o["d"])("span",O,"Brush Color: "+Object(o["j"])(t.brushColor),1)])}var j={name:"Statistics",props:{pos:Object,brushSize:{type:Number,default:1},brushColor:{type:String,default:"#000000"}}};t("4b71");const y=h()(j,[["render",k],["__scopeId","data-v-1c91d81e"]]);var B=y;const L={id:"leftImages"},P={class:"mode-indicator"},T={id:"imagesList"},W=["src"],A=["onClick"];function F(e,a,t,s,r,n){return Object(o["g"])(),Object(o["c"])("div",L,[a[3]||(a[3]=Object(o["d"])("h3",null,"Saved Images",-1)),Object(o["d"])("div",P,[Object(o["d"])("span",{class:Object(o["f"])(["mode-badge",r.currentMode])},Object(o["j"])("server"===r.currentMode?"Server Mode":"Local Storage"),3)]),Object(o["d"])("button",{onClick:a[0]||(a[0]=a=>e.$emit("save-image"))},"Save image"),Object(o["d"])("button",{onClick:a[1]||(a[1]=(...e)=>n.clearAllImages&&n.clearAllImages(...e))},"Delete All"),Object(o["d"])("div",T,[(Object(o["g"])(!0),Object(o["c"])(o["a"],null,Object(o["h"])(r.images,(t,s)=>(Object(o["g"])(),Object(o["c"])("div",{class:"image-container",key:s},[Object(o["d"])("img",{src:t.src,onClick:a[2]||(a[2]=a=>e.$emit("show-on-canvas",a.srcElement.currentSrc))},null,8,W),Object(o["d"])("button",{class:"delete-btn",onClick:e=>n.deleteImage(s)},"Delete",8,A)]))),128))])])}var x={name:"LeftImages",data(){return{images:[],currentMode:"localStorage"}},props:{savedImageWatcher:String},methods:{async deleteImage(e){this.images=v.deleteImage(e)},async getAllImages(){return await v.getAllImages()},async deleteAllImages(){await v.deleteAllImages(),this.images=[]},clearImagesDiv(){const e=document.getElementById("imagesList");while(e.firstChild)e.removeChild(e.firstChild)},async clearAllImages(){await this.deleteAllImages(),this.clearImagesDiv()},updateCurrentMode(){this.currentMode=v.getCurrentMode()}},watch:{savedImageWatcher:function(e){this.images.push(JSON.parse(e).image)}},async created(){this.images=await this.getAllImages(),this.updateCurrentMode(),setTimeout(()=>{this.updateCurrentMode()},1e3)}};t("e30e");const M=h()(x,[["render",F],["__scopeId","data-v-b956f69c"]]);var z=M,E={name:"App",components:{Toolbar:d,PaintCanvas:I,Statistics:B,LeftImages:z},data(){return{pos:{},brushColor:"#000000",brushSize:1,bgColor:"#ffffff",bgImage:"",showImage:"",isCanvasClear:!1,bgFileName:!1,saveImage:!1,downloadImage:!1,savedImage:""}},methods:{updateMousePos(e){this.pos=e},updateBrushColor(e){this.brushColor=e},updateBrushSize(e){this.brushSize=parseInt(e)},updateBgColor(e){this.bgColor=e},updateBgImage(e){this.bgImage=e},clearCanvas(){this.isCanvasClear=!this.isCanvasClear},clearBGfileName(){this.bgFileName=!this.bgFileName},saveImageTask(){this.saveImage=!this.saveImage},downloadImageTask(){this.downloadImage=!this.downloadImage,setTimeout(()=>{this.downloadImage=!this.downloadImage},100)},showImageTask(e){this.showImage=e},updateImageList(e){this.savedImage=e}}};t("cc21");const U=h()(E,[["render",r]]);var _=U;Object(o["b"])(_).mount("#app")},8100:function(e,a,t){},cc21:function(e,a,t){"use strict";t("f31f")},d0c8:function(e,a,t){"use strict";t("552a")},e30e:function(e,a,t){"use strict";t("8100")},e478:function(e,a,t){},f31f:function(e,a,t){},fd10:function(e,a,t){"use strict";t("0284")}});
//# sourceMappingURL=app.92014519.js.map